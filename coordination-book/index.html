<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fabric Swatch Collection</title>

  <!-- Tailwind (스타일) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 + ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel (브라우저에서 JSX 컴파일) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    html,body{
      font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro Text",
                   "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji",
                   "Segoe UI Emoji";
      background:#F5F2EE;
    }
  </style>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
  import {
    initializeFirestore, doc, getDoc, setDoc, onSnapshot, deleteField
  } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
  import { getAuth, signInAnonymously }
    from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
  import {
    getStorage, ref as sref, uploadString, getDownloadURL, uploadBytes
  } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDJbRAuqHhFQsHGgam-xeRFxOcxA9awTqM",
    authDomain: "coordination-book.firebaseapp.com",
    projectId: "coordination-book",
    storageBucket: "coordination-book.appspot.com",
    messagingSenderId: "139328147409",
    appId: "1:139328147409:web:b99eca7b99393a92249af0",
    measurementId: "G-F72EJY2TNK"
  };

  if (!window._fb) {
    const app = initializeApp(firebaseConfig);

    // ✅ Safari 우회: 스트리밍 fetch 끄고 long-polling 강제
    const db = initializeFirestore(app, {
      experimentalForceLongPolling: true,
      useFetchStreams: false
    });

    const st   = getStorage(app);
    const auth = getAuth(app);

    window._fb    = { app, db, st, auth };
    window._fbFns = {
      doc, getDoc, setDoc, onSnapshot, deleteField,
      sref, uploadString, getDownloadURL, uploadBytes
    };

    signInAnonymously(auth).catch(e => console.error("Anon sign-in error:", e));
  }
</script>


<!-- HEIC -> JPEG 변환 (UMD, window.heic2any 로 노출) -->
<script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>

  <!-- ✅ 앱 코드 불러오기 (네가 만든 app.jsx 파일) -->
  <script type="text/babel" data-presets="react" src="./app.jsx"></script>

</head>

<body>
  <div id="root"></div>
</body>
</html>